(function(){"use strict";var e={8906:function(e,t,n){var r=n(9963),o=n(6252);function i(e,t,n,r,i,u){var a=(0,o.up)("the-header"),l=(0,o.up)("router-view"),c=(0,o.up)("a-layout-content"),s=(0,o.up)("a-layout");return(0,o.wg)(),(0,o.j4)(s,{style:{"min-height":"100vh"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(a,{selected:""}),(0,o.Wm)(c,{style:{"margin-top":"64px"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(l)]})),_:1})]})),_:1})}var u=n(2262),a=n(3577),l=(0,o._)("span",{style:{"font-size":"1.5em"}},"大湖洲",-1);function c(e,t,n,r,i,u){var c=(0,o.up)("router-link"),s=(0,o.up)("a-menu-item"),d=(0,o.up)("a-input"),f=(0,o.up)("a-form-item"),p=(0,o.up)("a-form"),m=(0,o.up)("a-input-password"),h=(0,o.up)("a-button"),g=(0,o.up)("a-modal"),v=(0,o.up)("a-menu"),y=(0,o.up)("a-layout-header");return(0,o.wg)(),(0,o.j4)(y,{style:{position:"fixed",width:"100%","z-index":"9999"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(v,{selectedKeys:e.selectedKeys,"onUpdate:selectedKeys":t[4]||(t[4]=function(t){return e.selectedKeys=t}),theme:"dark",mode:"horizontal",style:{float:"right","max-height":"64px",display:"flex"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(s,{key:"home",style:{display:"flex","align-items":"center","justify-content":"center"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(c,{to:"/home"},{default:(0,o.w5)((function(){return[l]})),_:1})]})),_:1}),(0,o.Wm)(s,{key:"wiki"},{default:(0,o.w5)((function(){return[(0,o.Wm)(c,{to:"/home"},{default:(0,o.w5)((function(){return[(0,o.Uk)(" WIKI ")]})),_:1})]})),_:1}),"username"in e.loginUser&&""!==e.loginUser.username?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Wm)(s,{key:"username"},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(e.loginUser.username),1)]})),_:1}),(0,o.Wm)(s,{key:"editor"},{default:(0,o.w5)((function(){return[(0,o.Wm)(c,{to:"/editor"},{default:(0,o.w5)((function(){return[(0,o.Uk)(" 编辑器 ")]})),_:1})]})),_:1})],64)):((0,o.wg)(),(0,o.j4)(s,{key:"login",onClick:t[3]||(t[3]=function(t){return e.openLogin()})},{default:(0,o.w5)((function(){return[(0,o.Uk)(" 登录 "),(0,o.Wm)(g,{visible:e.visible,"onUpdate:visible":t[2]||(t[2]=function(t){return e.visible=t}),title:"Title",onOk:e.login},{footer:(0,o.w5)((function(){return[(0,o.Wm)(p,{model:e.formState,ref:"formRef"},{default:(0,o.w5)((function(){return[(0,o.Wm)(f,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(h,{type:"primary","html-type":"submit",onClick:e.login},{default:(0,o.w5)((function(){return[(0,o.Uk)("登录")]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model"])]})),default:(0,o.w5)((function(){return[(0,o.Wm)(p,{model:e.formState,ref:"formRef"},{default:(0,o.w5)((function(){return[(0,o.Wm)(f,{label:"用户名",name:"username"},{default:(0,o.w5)((function(){return[(0,o.Wm)(d,{value:e.formState.username,"onUpdate:value":t[0]||(t[0]=function(t){return e.formState.username=t})},null,8,["value"])]})),_:1})]})),_:1},8,["model"]),(0,o.Wm)(f,{label:"密码",name:"password"},{default:(0,o.w5)((function(){return[(0,o.Wm)(m,{value:e.formState.password,"onUpdate:value":t[1]||(t[1]=function(t){return e.formState.password=t})},null,8,["value"])]})),_:1})]})),_:1},8,["visible","onOk"])]})),_:1})),(0,o.Wm)(s,{key:"about"},{default:(0,o.w5)((function(){return[(0,o.Wm)(c,{to:"/about"},{default:(0,o.w5)((function(){return[(0,o.Uk)(" 关于我们 ")]})),_:1})]})),_:1}),(0,o.Wm)(s,{key:"contact"},{default:(0,o.w5)((function(){return[(0,o.Wm)(c,{to:"/home"},{default:(0,o.w5)((function(){return[(0,o.Uk)(" 联系我们 ")]})),_:1})]})),_:1})]})),_:1},8,["selectedKeys"])]})),_:1})}var s=n(4107),d=n(1446),f=n(3907),p="USER",m=(0,f.MT)({state:{user:SessionStorage.get(p)||{}},getters:{},mutations:{setUser:function(e,t){SessionStorage.set(p,t),e.user=t},clearUser:function(e){SessionStorage.remove(p),e.user={}}},actions:{},modules:{}}),h=m,g=(0,o.aZ)({name:"user-header",props:{selected:{type:String,required:!0,default:"home"}},setup:function(e){console.log("setup");var t=(0,u.iH)(!1),n=function(){s.Z.post("/user/login",i.value).then((function(e){d.ZP.success({content:e.data.message}),e.data.success&&(h.commit("setUser",{username:e.data.username,token:e.data.token}),t.value=!1)}))},r=(0,o.Fl)((function(){return h.state.user})),i=(0,u.iH)({username:"",password:""}),a=function(){t.value=!0};return{visible:t,login:n,formState:i,openLogin:a,loginUser:r,selectedKeys:(0,u.iH)([e.selected])}}}),v=n(3744);const y=(0,v.Z)(g,[["render",c]]);var w=y,b=(0,o.aZ)({components:{TheHeader:w},data:function(){return{collapsed:(0,u.iH)(!1),selectedKeys:(0,u.iH)(["1"])}}});const k=(0,v.Z)(b,[["render",i]]);var _=k,W=n(2201),O={style:{padding:"24px",background:"#fff",minHeight:"360px"}};function x(e,t,n,r,i,u){var a=(0,o.up)("editor-sidebar"),l=(0,o.up)("router-view"),c=(0,o.up)("the-footer"),s=(0,o.up)("a-layout-content"),d=(0,o.up)("a-layout");return(0,o.wg)(),(0,o.j4)(d,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(a,{style:{position:"fixed"}}),(0,o.Wm)(d,{style:{"margin-left":"80px"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(s,{style:{margin:"16px 16px"}},{default:(0,o.w5)((function(){return[(0,o._)("div",O,[(0,o.Wm)(l)]),(0,o.Wm)(c)]})),_:1})]})),_:1})]})),_:1})}var C=(0,o._)("span",null,"USER",-1),P=(0,o._)("span",null,"Server",-1);function D(e,t,n,r,i,u){var a=(0,o.up)("user-outlined"),l=(0,o.up)("a-menu-item"),c=(0,o.up)("desktop-outlined"),s=(0,o.up)("file-outlined"),d=(0,o.up)("a-sub-menu"),f=(0,o.up)("a-menu"),p=(0,o.up)("a-layout-sider");return(0,o.wg)(),(0,o.j4)(p,{collapsed:e.collapsed,"onUpdate:collapsed":t[1]||(t[1]=function(t){return e.collapsed=t}),style:{"margin-top":"-100px"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(f,{selectedKeys:e.selectedKeys,"onUpdate:selectedKeys":t[0]||(t[0]=function(t){return e.selectedKeys=t}),theme:"dark",mode:"inline",onClick:e.toggleClick,style:{"margin-top":"100px",height:"100vh",width:"100%"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(l,{key:"user"},{default:(0,o.w5)((function(){return[(0,o.Wm)(a),C]})),_:1}),(0,o.Wm)(l,{key:"server"},{default:(0,o.w5)((function(){return[(0,o.Wm)(c),P]})),_:1}),(0,o.Wm)(d,{key:"file"},{title:(0,o.w5)((function(){return[(0,o._)("span",null,[(0,o.Wm)(s)])]})),default:(0,o.w5)((function(){return[(0,o.Wm)(l,{key:"texture"},{default:(0,o.w5)((function(){return[(0,o.Uk)("Texture")]})),_:1}),(0,o.Wm)(l,{key:"dialog"},{default:(0,o.w5)((function(){return[(0,o.Uk)("Dialog")]})),_:1}),(0,o.Wm)(l,{key:"quest"},{default:(0,o.w5)((function(){return[(0,o.Uk)("Quest")]})),_:1}),(0,o.Wm)(l,{key:"wiki"},{default:(0,o.w5)((function(){return[(0,o.Uk)("Wiki")]})),_:1})]})),_:1})]})),_:1},8,["selectedKeys","onClick"])]})),_:1},8,["collapsed"])}var Z=n(3998),U=n(9655),j=n(4924),S=n(2393),N=n(2572),q=(0,o.aZ)({name:"editor-sidebar",components:{PieChartOutlined:Z.Z,DesktopOutlined:U.Z,UserOutlined:j.Z,TeamOutlined:S.Z,FileOutlined:N.Z},data:function(){return{collapsed:(0,u.iH)(!0),selectedKeys:(0,u.iH)()}},methods:{toggleClick:function(e){switch(e.key){case"server":this.$router.push("/editor/server");break;case"file":this.$router.push("/editor/file");break;case"dialog":this.$router.push("/editor/dialog");break;case"wiki":this.$router.push("/editor/wiki");break}}}});const L=(0,v.Z)(q,[["render",D]]);var H=L;function T(e,t,n,r,i,u){var a=(0,o.up)("a-layout-footer");return(0,o.wg)(),(0,o.j4)(a,{style:{"text-align":"center"}},{default:(0,o.w5)((function(){return[(0,o.Uk)(" Built by zljtt with Vue and Ant Design. Hosted by 氧桦铁. ")]})),_:1})}var I=(0,o.aZ)({name:"the-footer"});const F=(0,v.Z)(I,[["render",T]]);var K=F,E=(0,o.aZ)({name:"EditorView",components:{EditorSidebar:H,TheFooter:K,TheHeader:w},setup:function(){console.log("main editor setup")}});const R=(0,v.Z)(E,[["render",x]]);var A=R,V=(0,o._)("span",null,"File",-1),G={class:"ant-upload-drag-icon"},z=(0,o._)("p",{class:"ant-upload-text"},"Click or drag file to this area to upload",-1),M=(0,o._)("p",{class:"ant-upload-hint"}," Support for a single or bulk upload. Strictly prohibit from uploading company data or other band files ",-1);function Q(e,t,n,r,i,u){var a=(0,o.up)("inbox-outlined"),l=(0,o.up)("a-upload-dragger"),c=(0,o.up)("a-layout");return(0,o.wg)(),(0,o.j4)(c,null,{default:(0,o.w5)((function(){return[V,(0,o.Wm)(l,{fileList:e.fileList,"onUpdate:fileList":t[0]||(t[0]=function(t){return e.fileList=t}),name:"file",action:"http://localhost:25565/editor/file/texture",multiple:!1,onChange:e.handleChange,onDrop:e.handleDrop},{default:(0,o.w5)((function(){return[(0,o._)("p",G,[(0,o.Wm)(a)]),z,M]})),_:1},8,["fileList","onChange","onDrop"])]})),_:1})}var J=n(515),Y=(0,o.aZ)({name:"EditorView",components:{EditorSidebar:H,TheFooter:K,InboxOutlined:J.Z},setup:function(){console.log("file editor setup");var e=function(e){var t=e.file.status;"uploading"!==t&&console.log(e.file,e.fileList),"done"===t?d.ZP.success("".concat(e.file.name," file uploaded successfully.")):"error"===t&&d.ZP.error("".concat(e.file.name," file upload failed."))};return{handleChange:e,fileList:(0,u.iH)([]),handleDrop:function(e){console.log(e)}}}});const $=(0,v.Z)(Y,[["render",Q]]);var B=$,X=(0,o._)("span",null,"Server",-1);function ee(e,t,n,r,i,u){var a=(0,o.up)("a-layout");return(0,o.wg)(),(0,o.j4)(a,null,{default:(0,o.w5)((function(){return[X]})),_:1})}var te=(0,o.aZ)({name:"EditorView",components:{EditorSidebar:H,TheFooter:K},setup:function(){console.log("server editor setup")}});const ne=(0,v.Z)(te,[["render",ee]]);var re=ne;function oe(e,t,n,r,i,u){var l=(0,o.up)("a-typography-title"),c=(0,o.up)("a-auto-complete"),s=(0,o.up)("a-button"),d=(0,o.up)("a-divider"),f=(0,o.up)("a-typography-paragraph"),p=(0,o.up)("a-tree-select"),m=(0,o.up)("a-form-item"),h=(0,o.up)("a-input"),g=(0,o.up)("a-col"),v=(0,o.up)("MinusCircleOutlined"),y=(0,o.up)("a-popconfirm"),w=(0,o.up)("a-row"),b=(0,o.up)("a-form"),k=(0,o.up)("PlusOutlined"),_=(0,o.up)("a-space"),W=(0,o.up)("a-layout-content"),O=(0,o.up)("a-layout");return(0,o.wg)(),(0,o.j4)(O,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(W,{style:{"background-color":"#FFFFFF",padding:"0 50px"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(l,{level:2,style:{"margin-top":"20px"}},{default:(0,o.w5)((function(){return[(0,o.Uk)("NPC 对话")]})),_:1}),(0,o.Wm)(c,{value:e.npcName,"onUpdate:value":t[0]||(t[0]=function(t){return e.npcName=t}),style:{width:"200px"},placeholder:"输入 NPC ID",options:e.searchOptions,onSearch:e.onSearch},null,8,["value","options","onSearch"]),(0,o.Wm)(s,{onClick:e.onCreate,disabled:e.fileLoaded},{default:(0,o.w5)((function(){return[(0,o.Uk)("加载/创建")]})),_:1},8,["onClick","disabled"]),e.fileLoaded?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(d),(0,o.Wm)(l,{level:3,content:e.npcDisplayName,"onUpdate:content":t[1]||(t[1]=function(t){return e.npcDisplayName=t}),editable:"",style:{"margin-top":"5px"}},null,8,["content"]),(0,o.Wm)(f,{content:e.npcDescription,"onUpdate:content":t[2]||(t[2]=function(t){return e.npcDescription=t}),editable:"",style:{"margin-top":"5px"}},null,8,["content"]),(0,o.Wm)(d),(0,o.Wm)(b,{ref:"formRef",model:e.getCurrentDialog(),layout:"horizontal"},{default:(0,o.w5)((function(){var n,r;return[(0,o.Wm)(m,{label:"选择对话节点"},{default:(0,o.w5)((function(){return[(0,o.Wm)(p,{"show-search":"","allow-clear":"","tree-default-expand-all":"",style:{width:"100%"},defaultValue:"root",value:e.currentNodeValue,"onUpdate:value":t[3]||(t[3]=function(t){return e.currentNodeValue=t}),"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.npcDialogs},{title:(0,o.w5)((function(t){var n=t.value,r=t.title;return[(0,o.Uk)((0,a.zw)(e.getParentOption(n,r)),1)]})),_:1},8,["value","tree-data"])]})),_:1}),(0,o.Wm)(d),""!==e.currentNodeValue&&void 0!==e.currentNodeValue&&"NO_DIALOG"!==e.getCurrentDialog().title?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(m,{label:"NPC对话",rules:{required:!0,message:"对话一定要有个头吧",trigger:"change"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(h,{value:e.getCurrentDialog().title,"onUpdate:value":t[4]||(t[4]=function(t){return e.getCurrentDialog().title=t}),placeholder:e.getCurrentDialog().title,style:{width:"100%"}},null,8,["value","placeholder"])]})),_:1}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(null!==(r=null===(n=e.getCurrentDialog())||void 0===n?void 0:n.options)&&void 0!==r?r:[],(function(t,n){return(0,o.wg)(),(0,o.j4)(_,{key:t,size:"small",direction:"vertical",style:{width:"100%","border-style":"dashed","border-color":"gainsboro","border-bottom":"transparent"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(b,{layout:"horizontal",style:{"margin-left":"10px"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(w,{style:{width:"100%"},align:"start"},{default:(0,o.w5)((function(){return[(0,o.Wm)(g,{span:19,style:{"margin-top":"10px"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(m,{label:"玩家选项"},{default:(0,o.w5)((function(){return[(0,o.Wm)(f,{content:t.text,"onUpdate:content":function(e){return t.text=e},editable:"",style:{"margin-top":"5px"}},null,8,["content","onUpdate:content"])]})),_:2},1024)]})),_:2},1024),(0,o.Wm)(g,{span:5},{default:(0,o.w5)((function(){return[(0,o.Wm)(y,{title:"真的要删除这个选项吗？这会删除所有下层目录",placement:"topRight","ok-text":"确定","cancel-text":"取消",onConfirm:function(t){return e.removeOption(n)}},{default:(0,o.w5)((function(){return[(0,o.Wm)(s,{type:"dashed",danger:"",style:{float:"right"}},{default:(0,o.w5)((function(){return[(0,o.Uk)(" 删除选项 "),(0,o.Wm)(v)]})),_:1})]})),_:2},1032,["onConfirm"])]})),_:2},1024)]})),_:2},1024),(0,o.Wm)(b,{layout:"inline"},{default:(0,o.w5)((function(){return[(0,o.Wm)(m,{label:"等级需求",rules:{required:!1}},{default:(0,o.w5)((function(){return[(0,o.Wm)(f,{content:t.requireLevel,"onUpdate:content":function(e){return t.requireLevel=e},editable:"",style:{"margin-top":"5px",width:"100px"}},null,8,["content","onUpdate:content"])]})),_:2},1024),(0,o.Wm)(m,{label:"任务需求",rules:{required:!1}},{default:(0,o.w5)((function(){return[(0,o.Wm)(f,{content:t.requireQuest,"onUpdate:content":function(e){return t.requireQuest=e},editable:"",style:{"margin-top":"5px",width:"100px"}},null,8,["content","onUpdate:content"])]})),_:2},1024)]})),_:2},1024),(0,o.Wm)(b,{layout:"inline",style:{"min-height":"45px"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(m,{label:"下一级NPC对话",rules:{required:!1}},{default:(0,o.w5)((function(){return["NO_DIALOG"!==e.getCurrentDialog().children[n].title?((0,o.wg)(),(0,o.j4)(f,{key:0,content:e.getCurrentDialog().children[n].title,"onUpdate:content":function(t){return e.getCurrentDialog().children[n].title=t},onClick:function(t){return e.goToDirectory(e.getCurrentDialog().children[n].value)},editable:"",style:{"margin-top":"5px"}},null,8,["content","onUpdate:content","onClick"])):(0,o.kq)("",!0),"NO_DIALOG"===e.getCurrentDialog().children[n].title?((0,o.wg)(),(0,o.j4)(s,{key:1,type:"dashed",onClick:function(t){return e.addOptionDialog(n)}},{default:(0,o.w5)((function(){return[(0,o.Wm)(k),(0,o.Uk)(" 设立下级对话 ")]})),_:2},1032,["onClick"])):(0,o.kq)("",!0)]})),_:2},1024),(0,o.Wm)(m,null,{default:(0,o.w5)((function(){return["NO_DIALOG"!==e.getCurrentDialog().children[n].title?((0,o.wg)(),(0,o.j4)(y,{key:0,title:"真的要删除所有下层对话吗？","ok-text":"确定","cancel-text":"取消",onConfirm:function(t){return e.clearOptionDialog(n)}},{default:(0,o.w5)((function(){return[(0,o.Wm)(v,{style:{}})]})),_:2},1032,["onConfirm"])):(0,o.kq)("",!0)]})),_:2},1024)]})),_:2},1024)]})),_:2},1024)]})),_:2},1024)})),128)),(0,o.Wm)(m,{rules:{required:!1,message:"Fields can not be null",trigger:"change"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(s,{type:"dashed",onClick:t[5]||(t[5]=function(t){return e.addOption()}),style:{width:"100%"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(k),(0,o.Uk)(" 增加选项 ")]})),_:1})]})),_:1}),(0,o.Wm)(d)],64)):(0,o.kq)("",!0)]})),_:1},8,["model"]),(0,o.Wm)(y,{title:"真的要保存吗？这会覆盖原来的文件",placement:"topLeft","ok-text":"确定","cancel-text":"取消",onConfirm:t[6]||(t[6]=function(t){return e.sendJson()})},{default:(0,o.w5)((function(){return[(0,o.Wm)(s,{type:"primary"},{default:(0,o.w5)((function(){return[(0,o.Uk)("保存")]})),_:1})]})),_:1}),(0,o.Wm)(d,{type:"vertical"}),(0,o.Wm)(y,{title:"真的要永远删除这个NPC吗？",placement:"topLeft","ok-text":"确定","cancel-text":"取消",onConfirm:t[7]||(t[7]=function(t){return e.onDeleteFile()})},{default:(0,o.w5)((function(){return[(0,o.Wm)(s,{disabled:!e.fileLoaded,type:"primary",danger:""},{default:(0,o.w5)((function(){return[(0,o.Uk)("删除NPC")]})),_:1},8,["disabled"])]})),_:1})],64)):(0,o.kq)("",!0)]})),_:1})]})),_:1})}var ie=n(166),ue=n(4218);function ae(e,t,n,r,i,u){var a=(0,o.up)("the-dialog",!0),l=(0,o.up)("a-collapse-panel"),c=(0,o.up)("a-collapse");return(0,o.wg)(),(0,o.j4)(c,null,{default:(0,o.w5)((function(){return[((0,o.wg)(),(0,o.j4)(l,{key:e.dialog.panelId,header:e.dialog.dialog},{default:(0,o.w5)((function(){return[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.dialog.options,(function(e){return(0,o.wg)(),(0,o.j4)(l,{key:e.panelId,header:e.text},{default:(0,o.w5)((function(){return[e.next?((0,o.wg)(),(0,o.j4)(a,{key:0,dialog:e.next},null,8,["dialog"])):(0,o.kq)("",!0)]})),_:2},1032,["header"])})),128))]})),_:1},8,["header"]))]})),_:1})}var le=(0,o.aZ)({name:"the-dialog",props:{dialog:{required:!0}}});const ce=(0,v.Z)(le,[["render",ae]]);var se=ce,de=(0,o.aZ)({name:"DialogEditorView",components:{MinusCircleOutlined:ie.Z,PlusOutlined:ue.Z,TheDialog:se,EditorSidebar:H,InboxOutlined:J.Z},setup:function(){d.ZP.config({top:"100px",duration:2,maxCount:3,rtl:!0,prefixCls:""}),console.log("dialog editor setup");var e=(0,u.iH)([]),t=function(t){var n=encodeURIComponent(t),r="/editor/dialog/list?prefix=".concat(n);s.Z.get(r).then((function(t){t.data?e.value=t.data.map((function(e){return{value:e}})):e.value=[]}))},n=(0,u.iH)(),r=(0,u.iH)(!1),i=(0,u.iH)(),a=(0,u.iH)(""),l=(0,u.iH)();(0,o.YP)(n,(function(){r.value=!1}));var c=function(){var e="createMessage";d.ZP.loading({content:"加载中...",key:e});var t=encodeURIComponent(n.value||""),o="/editor/dialog/get?name=".concat(t);s.Z.get(o).then((function(t){if("NOT_FOUND"==t.data.fileStatus)return l.value=[new pe("root","第一条对话")],i.value="还没有名字",a.value="还没有NPC设定",r.value=!0,void d.ZP.loading({content:"创建新NPC",key:e});try{var n=JSON.parse(t.data.content);l.value="dialogs"in n?[fe(n["dialogs"],"root")]:[new pe("root","还没有对话")],i.value="name"in n&&""!=n["name"]?n["name"]:"还没有名字",a.value="description"in n&&""!=n["description"]?n["description"]:"还没有NPC设定",r.value=!0,d.ZP.success({content:t.data.message,key:e})}catch(o){d.ZP.success({content:t.data.message,key:e})}}))},f=(0,u.iH)(""),p=function(e){var t=y();t&&t.removeOption(e)},m=function(e){var t=y();t&&t.removeDialog(e)},h=function(){var e=y();e&&e.addOption()},g=function(e){var t=y();t&&t.addDialog(e)},v=function(e,t){if(!l.value||!e)return"";var n="";return"root"!=e&&(n+="("+l.value[0].searchParentOption(e)+") "),n+("NO_DIALOG"==t?"结束对话":t)},y=function(){return l.value&&l.value.length>0?l.value[0].deepSearch(f.value):new pe("","NO_DIALOG")},w=function(e){f.value=e},b=function(){var e="saveMessage";if(d.ZP.loading({content:"加载中...",key:e}),r.value){if(!i.value||""==i.value)return void d.ZP.warn({content:"NPC的名字不能为空",key:e});if(!n.value)return void d.ZP.warn({content:"NPC的ID不能为空",key:e});if(!l.value)return void d.ZP.warn({content:"NPC不能没有对话",key:e});var t=JSON.stringify({name:"还没有名字"==i.value?"":i.value,description:"还没有NPC设定"==a.value?"":a.value,dialogs:l.value[0].toJson()});try{var o=encodeURIComponent(n.value),u="/editor/dialog/upload?name=".concat(o);s.Z.post(u,t,{headers:{"Content-Type":"application/json"}}).then((function(t){return d.ZP.success({content:t.data.message,key:e})}))}catch(c){d.ZP.warn({content:"保存失败",key:e})}}else d.ZP.warn({content:"还没加载或创建NPC",key:e})},k=function(){var e="deleteMessage";if(d.ZP.loading({content:"删除中...",key:e}),r.value){if(!n.value)return void d.ZP.warn({content:"NPC的ID不能为空",key:e});try{var t=encodeURIComponent(n.value),o="/editor/dialog/delete?name=".concat(t);s.Z.post(o,{headers:{"Content-Type":"application/json"}}).then((function(t){return d.ZP.success({content:t.data.message,key:e})}))}catch(i){d.ZP.warn({content:"删除失败",key:e})}}};return{npcName:n,npcDisplayName:i,npcDescription:a,searchOptions:e,fileLoaded:r,onSearch:t,onCreate:c,removeOption:p,clearOptionDialog:m,addOption:h,goToDirectory:w,addOptionDialog:g,getParentOption:v,getCurrentDialog:y,sendJson:b,onDeleteFile:k,npcDialogs:l,currentNodeValue:f}}});function fe(e,t){var n=new pe(t,e["dialog"]),r=0;"optionCount"in e&&(r=e["optionCount"]);for(var o=0;o<r;o++){var i=e["option"+(o+1)],u=t+".option"+(o+1).toString(),a=new me(u,i["text"]);"next"in i?n.children.push(fe(i["next"],u)):n.children.push(new pe(u,"NO_DIALOG")),"require"in i&&(a.requireQuest=i["require"]["quest"],a.requireLevel=i["require"]["level"].toString()),n.options.push(a)}return n}var pe=function(){function e(e,t){Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"title",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"children",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e,this.title=t,this.children=[],this.options=[]}return Object.defineProperty(e.prototype,"toJson",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e={};if(e.dialog=this.title,0==this.options.length)return e;e.optionCount=this.options.length;for(var t=0;t<this.options.length;t++){var n={};if(n.text=this.options[t].text,""!=this.options[t].requireLevel||""!=this.options[t].requireQuest){var r=Number(this.options[t].requireLevel);r||(r=0),n.require={level:r,quest:""==this.options[t].requireQuest?"NONE":this.options[t].requireLevel}}"NO_DIALOG"!=this.children[t].title&&(n.next=this.children[t].toJson()),e["option"+(t+1)]=n}return e}}),Object.defineProperty(e.prototype,"deepSearch",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this.value==e)return this;for(var t=0;t<this.children.length;t++){var n=this.children[t].deepSearch(e);if(void 0!=n)return n}}}),Object.defineProperty(e.prototype,"searchParentOption",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=0;t<this.children.length;t++)if(this.children[t].value==e)return this.options[t].text;for(t=0;t<this.children.length;t++){var n=this.children[t].searchParentOption(e);if(""!=n)return n}return""}}),Object.defineProperty(e.prototype,"addOption",{enumerable:!1,configurable:!0,writable:!0,value:function(){var t=this.value+".option"+(this.children.length+1).toString();this.options.push(new me(t,t)),this.children.push(new e(t,"NO_DIALOG"))}}),Object.defineProperty(e.prototype,"addDialog",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.children.length>e&&(this.children[e].title=this.children[e].value)}}),Object.defineProperty(e.prototype,"removeDialog",{enumerable:!1,configurable:!0,writable:!0,value:function(t){this.children[t]=new e(this.children[t].value,"NO_DIALOG")}}),Object.defineProperty(e.prototype,"removeOption",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.options[e].dir;this.options=this.options.filter((function(e){return e.dir!=t})),this.children=this.children.filter((function(e){return e.value!=t}))}}),e}(),me=function(){function e(e,t){Object.defineProperty(this,"dir",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"requireLevel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"requireQuest",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.dir=e,this.text=t,this.requireLevel="",this.requireQuest=""}return e}();const he=(0,v.Z)(de,[["render",oe]]);var ge=he,ve=(0,o._)("span",null,"Wiki",-1);function ye(e,t,n,r,i,u){var a=(0,o.up)("a-layout");return(0,o.wg)(),(0,o.j4)(a,null,{default:(0,o.w5)((function(){return[ve]})),_:1})}var we=(0,o.aZ)({name:"EditorView",components:{EditorSidebar:H,TheFooter:K},setup:function(){console.log("server editor setup")}});const be=(0,v.Z)(we,[["render",ye]]);var ke=be;function _e(e,t,n,r,i,u){var a=(0,o.up)("a-typography-title"),l=(0,o.up)("a-layout-content"),c=(0,o.up)("the-footer"),s=(0,o.up)("a-layout");return(0,o.wg)(),(0,o.j4)(s,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(l,{style:{margin:"16px 16px"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(a,{level:1,style:{"margin-top":"20px"}},{default:(0,o.w5)((function(){return[(0,o.Uk)("欢迎来到大湖洲")]})),_:1})]})),_:1}),(0,o.Wm)(c)]})),_:1})}var We=(0,o.aZ)({components:{TheHeader:w,TheFooter:K},data:function(){return{collapsed:(0,u.iH)(!1),selectedKeys:(0,u.iH)(["1"])}}});const Oe=(0,v.Z)(We,[["render",_e]]);var xe=Oe;function Ce(e,t,n,r,i,u){var a=(0,o.up)("a-typography-title"),l=(0,o.up)("a-layout-content"),c=(0,o.up)("the-footer"),s=(0,o.up)("a-layout");return(0,o.wg)(),(0,o.j4)(s,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(l,{style:{margin:"16px 16px"}},{default:(0,o.w5)((function(){return[(0,o.Wm)(a,{level:1,style:{"margin-top":"20px"}},{default:(0,o.w5)((function(){return[(0,o.Uk)("关于我们")]})),_:1})]})),_:1}),(0,o.Wm)(c)]})),_:1})}var Pe=(0,o.aZ)({components:{TheHeader:w,TheFooter:K},data:function(){return{collapsed:(0,u.iH)(!1),selectedKeys:(0,u.iH)(["1"])}}});const De=(0,v.Z)(Pe,[["render",Ce]]);var Ze=De,Ue=[{path:"/",name:"index",redirect:"/home"},{path:"/home",name:"Home",component:xe},{path:"/about",name:"About",component:Ze},{path:"/editor",name:"Editor",component:A,meta:{loginRequire:!0},children:[{path:"/editor/file",name:"File",component:B},{path:"/editor/server",name:"Server",component:re},{path:"/editor/dialog",name:"Dialog",component:ge},{path:"/editor/wiki",name:"Wiki",component:ke}]}],je=(0,W.p7)({history:(0,W.PO)("/"),routes:Ue});je.beforeEach((function(e,t,n){if(window.scrollTo(0,0),e.matched.some((function(e){return e.meta.loginRequire}))){var r=h.state.user;null!=r&&"undefined"!=typeof r&&"username"in r&&r.username&&""!=r.username?n():(console.log("User not login"+r),n("/"))}else n()}));var Se=je,Ne=n(7479);n(2467);s.Z.interceptors.request.use((function(e){var t=h.state.user.token;return t&&"undefined"!=typeof t&&e.headers&&(e.headers.token=t),console.log("Requesting: ",e),e}),(function(e){return Promise.reject(e)})),s.Z.interceptors.response.use((function(e){return console.log("Obtaining: ",e),e}),(function(e){return e.response&&401===e.response.status&&(console.log("Received 401 response"),h.commit("clearUser"),Se.push("/home")),Promise.reject(e)})),(0,r.ri)(_).use(h).use(Se).use(Ne.ZP).mount("#app"),s.Z.defaults.baseURL="http://fe2o3.f3322.net:11451/api",console.log("Starting with production mode with server http://fe2o3.f3322.net:11451/api")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,r,o,i){if(!r){var u=1/0;for(s=0;s<e.length;s++){r=e[s][0],o=e[s][1],i=e[s][2];for(var a=!0,l=0;l<r.length;l++)(!1&i||u>=i)&&Object.keys(n.O).every((function(e){return n.O[e](r[l])}))?r.splice(l--,1):(a=!1,i<u&&(u=i));if(a){e.splice(s--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var s=e.length;s>0&&e[s-1][2]>i;s--)e[s]=e[s-1];e[s]=[r,o,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,i,u=r[0],a=r[1],l=r[2],c=0;if(u.some((function(t){return 0!==e[t]}))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(l)var s=l(n)}for(t&&t(r);c<u.length;c++)i=u[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(s)},r=self["webpackChunkweb"]=self["webpackChunkweb"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(8906)}));r=n.O(r)})();
//# sourceMappingURL=app.0f9fbf76.js.map